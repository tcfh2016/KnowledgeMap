# 基本数据类型

Python里的任何类型都被视作object，可以使用 `type(t)`命令来查看值或者变量的数据类型。
Python主要的内置类型可以分为数字、序列、和映射三大类，但实际上包括了数字、字符串、列表、
字典、元组、文件、集合、用户定义类型及其他比如布尔型、None等。

## 一、数字

包括整数、浮点数、二进制、分数等，支持加法和乘法等操作。

整数，包括 `+ - * / ** % //`六种算术运算。Python对整数的长度没有限制。浮点，所有适用整
数的算术运算均适合浮点类型，然而浮点数存在上限和下限，且可能产生溢出。基于这一点考虑通常
优先考虑整数。decimal模块可用于控制浮点数的操作。

Python携带的`math`函数库提供了常用的数据处理函数。

Python提供了很多内置函数来进行类型转换：

- 将整数转换为浮点数，比如`float(3)`。
- 将字符串转换为浮点数，比如`float('3.0')`。
- 使用`str(87)`将数字转换为字符串。
- 自动类型转换，比如整数与浮点类型的运算结果自动转换为浮点类型。
- 将浮点型转换为整形可以使用 `int(8.64)`也可以使用`round(8.64)`，前者直接将小数部分删
  除，后者的策略比较特殊，即圆整到最接近的偶数。
- 内置函数`hex(I)`、`oct(I)`和`bin(I)`把一个整数转换为对应进制的字符串。
- 内置函数`int(str, base)`根据指定的进制把字符串转换为一个整数。


## 二、序列

包括字符串、列表、元组，支持索引、分片和合并等操作。

序列的索引是按照从最前面的偏移量进行编码的，也就是从0开始，第一项索引为0，第二项索引为1，
依次类推。Python支持反向索引，从最后一个开始计算。一般来说，负的索引号会简单地与字符串的
长度相加。

需要留意的是，尽管序列操作是通用的，但方法不通用。一条简明的法则是这样的：可作用于多种类
型的通用型操作都是以内置函数或表达式的形式出现的（比如len(X), x[0]），但类型特定的操作是
以方法调用的形式出现的（比如string.upper()）。你可以通过dir来查看对象支持的所有方法，并
使用help来查找帮助信息。

### 字符串

字符串，字符串可以通过单引号、双引号、三引号来包含，前两种形式没有太大区别但可以使得这两
种类型互相包含，而三引号则可以包含多行字符串。字符串的使用场景非常多，所以Python提供了强
大的字符串支持。

Python也支持原始（raw）字符串常量，即去掉反斜线转移机制，这样的字符串常量以字符“r”开头。

常见的字符串操作包括：

- 获取长度，通过调用`len(s)`来完成。
- 字符串拼接，使用`+`进行简单相加。
- t.capitalize()，转换为大写形式。
- t.split()，字符串分割，返回list。
- t.find('string')，查找字符串，返回index，未找到返回-1。
- t.replace(' ', '|')，替换字符。
- t.strip('htp:/')，删除特定字符串`头尾`特定的字符。*一定是头尾啊，其他地方用replace*
- t.rstrip()，删除字符串最右边的空白字符（未传入指定字符集作为参数）。

### 元组

元组与字符串、列表同属于序列类型，即按照顺序排列的一组值，支持索引和切片。

元组的特点：

- 不可变，杜绝了无意修改元组的可能，有助于防范错误。--> 提供了一种完整性的约束。
- 即便对元组进行细微修改，必须复制元组再创建新元组。
- 支持 `x in s`来检查元素是否在序列中。

元组的定义：

```
pets = ()                        # 创建空元组。
pets = ('dog',)                  # 创建单个元素的元组，逗号不可省略。
pets = ('dog', 'cat', 'bird',)   # 创建包含3个元素的元组，最后一个逗号可以省略。
```

### 列表

list是一种可以将多个数值组合在一起的复合数据类型，这些数值可以是不同的数据类型。当然list
也可以内嵌包含。相比元组，列表可以在不复制的情况下添加、删除或修改元素。

- len()获取长度。
- 使用方括号来定义，支持索引和切片。对列表进行分片时往往返回一个新的列表。
- 定义包含单个元素的列表不需要逗号结尾。
- list.sort()和list.reverse()会就地修改列表，不会制作拷贝。
- list.extend(anotherlist)类似于 list.append(element)，在末尾添加元素，但前者添加整
个列表。

列表解析(list comprehensions)是创建列表的特殊方法，它是一种通过对序列中的每一项运行一个
表达式来创建一个新列表的方法，每次一个，从左到右，它编写起来更加精简，且比手动的for循环语
句运行得更快（往往会快1倍），因为迭代在解析器内部是以C语言的速度执行的。当考虑在每项上执
行一个操作时，都可以考虑使用列表解析。

```
# 空列表
l = []

# example 1:
[n*n for n in rang(1,11)] # 这种方式可以变形为 l = [n for n in range(1,11)]

# example 2:
numbers = [-1, 0, 6, -4, -2, 3]
res = [n for n in numbers if n > 0]

# example 3: 如何生成多个相同元素的列表？
res = [9] * 8 # 生成8个包含9的列表

# 创建 1000000 个符合均值1.5方差2的伪随机数。
a = [gauss(1.5, 2) for i in range(1000000)]

# 移除字母p开头的行末尾的换行符
lines = [line.rstrip() for line in open('script1.py') if line[0] == 'p']
```

1) subsetting lists

list里面元素的索引从前往后从0开始，从后往前自-1开始：

```
[a, b, c, d, e, f, g]
 0  1  2  3  4  5  6
-7 -6 -5 -4 -3 -2 -1
```

2) List slicing

list切片遵循前闭后开的原则：[start, end)，同时也支持省略：省略start默认从第一个元素开始，
省略end，默认最后一个元素+1。`list[-3:]`表示选中“从倒数第3个到列表最后一个”。

修改元素直接通过索引进行重新赋值即可。

3) 增删操作

列表的扩展可以通过"+"操作来完成（列表+列表，添加单一元素使用`append()`方法），而删除操
作需要使用`del()`指定对应列表元素集合。

*`;`用来在一行代码里面分割不同的代码指令。*

4) 列表拷贝

直接通过“=”来拷贝列表那么拷贝变量和被拷贝变量都指向相同的对象，

```
# areas, areas_copy都指向相同的对象。
areas = [11.25, 18.0, 20.0, 10.75, 9.50]
areas_copy = areas

# 通过list()进行复制拷贝，areas, areas_copy都指向各自不同的对象。
areas = [11.25, 18.0, 20.0, 10.75, 9.50]
areas_copy = list(areas)

```

5) 遍历操作（Excursion）

使用`for`语句来遍历列表，Python提供了一种极具扩展性的遍历方式使得你可以不用去管被遍历的
list中元素的数据类型。

6) 常见方法

  - len(list) 获取列表的长度。比如计算平均值 sum(list) / len(list),sum()属于内建函数。
  - min(list)
  - max(list)
  - list.sort() 默认升序的排序操作，可以通过`reverse=True`转换为降序，`key`来指定排序方法。

7）查询操作

```
if 3 in l:
  pass
else:
  pass
```

## 三、映射

主要有字典，支持通过键进行索引。其中的列表和字典是可变的，而数字、字符串、元组是不可变的。

### 字典

字典类似小型数据库，使用健高效地存储和检索数据。字典中的每个键都被转换为一个数字，即散列
值，字典的值存储在底层列表中，散列值被用做它们的索引。访问值时，把提供的键转换为散列值，
再跳到列表的对应位置。

- 字典中的键必须唯一。
- 键是不可变的。
- 在访问键值时如果不确定键是否存在可以先用`key in d`进行检查。
- 函数keys(), items(), values()可以创建视图。

0）键的创建

键的创建方式有多种：

- 使用常量的方式
- 声明一个空字典，然后每次以一个键来填充它

```
color = {'red':1, 'blue':2, 'green':3}

color = {}
color['red'] = 1
```

1）键的排序

相比list, dict是无序而且也无法排序。如果我们确实需要强调某种顺序的时候，一个常用的解决办
法就是通过字典的keys方法收集一个键的列表，使用列表的sort方法进行排序，然后使用Python的
for循环逐个进行显示结果：

```
ks = list(D.keys())
ks.sort()
for key in ks:
  print(key, '=>', D[key])

for key in sorted(D):
  print(key, '=>', D[key])
```

2）if测试

我们能够通过给新的键赋值来扩展字典，但是获取一个不存在的键值仍然是一个错误。避免该错误的
一个技巧就是使用in关系表达式进行测试。

```
'f' in D

if not 'f' in D:
  print('missing')
```

## 四、文件

文件对象是Python代码对电脑上外部文件的主要接口。虽然文件是核心类型，但是它有些特殊：没有
特定的常量语法创建文件。要创建一个文件对象，需调用内置的open函数以字符串的形式传递给它一
个外部的文件名以及一个处理模式的字符串。

```
f = open('data.txt', 'w')
f.write('hello\n')

f = open('data.txt', 'r')
text = f.read()
```

## 五、集合

集合是一系列不重复的元素，类似于字典，但只包含键没有值，它的顺序是不确定的。由于它的使用
场景较少，暂不详述。

集合（set）可以用来把重复项从其他集合（collection）中过滤掉，直接把collection转换为set
然后再转换回来即可：

```
l = [1, 2, 1, 3, 2, 4, 5]
l = list(set(l))
```

集合可以求取交集、并集和差集：

```
(set(['b', 'r', 'u', 'o', 'n']), set(['e', 'o', 'g', 'l']))   # 重复的被删除
>>> x & y         # 交集
set(['o'])
>>> x | y         # 并集
set(['b', 'e', 'g', 'l', 'o', 'n', 'r', 'u'])
>>> x - y         # 差集
set(['r', 'b', 'u', 'n'])
```

# 六、用户定义的类

类定义了新的对象类型，扩展了核心类型。
