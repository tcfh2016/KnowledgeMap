# 聚宽学习周记二二：详解@云帆的“高频因子探索——动量交易”（上）


## 一、代码解释

### 代码片段


## 上周计划

### 1. 继续学习@云帆的[高频因子探索——动量交易](https://www.joinquant.com/view/community/detail/22472)。

重复理解了一下原文中的`get_profit_minutes_period()`和`get_open_profit_minutes_period()`函数，始终觉得有难以理解的地方。重新理解如下：

函数`get_profit_minutes_period()`的注释是“计算date前一天最后一段时间的动量收益，n为开盘收益计算时间长度，next_n为开盘后收益计算长度”，但到底是什么意思呢？我们假设按照默认值n=5, next_n=120来理解，那么：

- `open_profit`列的数据为下午开盘后1分钟相对于前5分钟的动量数据。*衡量下午开盘时的动量。*
- `next_profit`列的数据为下午开盘后120分钟的数据相当于前120分钟，即下午收盘时相对于下午开盘时的动量。*衡量下午收盘时的动量。*

函数`get_open_profit_minutes_period()`的注释是“计算date前一天开盘的动量收益，n为开盘收益计算时间长度，next_n为开盘后收益计算长度”，我们依然按照默认值n=5, next_n=120来理解，由于函数中获取到的是前一天240分钟（即整天的行情数据），那么：

- `open_profit`列的数据为上午开盘后5分钟相对于上午开盘时的动量数据。*衡量上午开盘时的动量。*
- `next_profit`列的数据为下午开盘后5分钟相对于上午开盘时的动量数据。*衡量上午收盘时的动量。*

我在阅读代码的时候始终觉得这两个函数似同似异，就算写出自己的理解也没有完全明白，于是只好画了下面这张图才算明白了：

![](./w23-momentum-demonstrate.png)

按如上图示，这两个函数一个计算上午开盘和收盘的动量，另一个计算下午开盘和收盘的动量，两者计算开盘和收盘动量的计算长度不一样。相同点在于两个函数开盘时都按5分钟时长进行计算，收盘时都按120分钟进行计算；不同点在于计算上午收盘时的动量取用了下午开始5分钟做为补充数据，而计算下午开盘时动量取用了上午最后5分钟作为补充数据。

为什么要这么上下补充呢，我的一个猜测是作者为了方便临时这么取用的。其他的原因暂时想不出。

2. 基于本周学习到的新的动量计算算法，以及前面两周研究指数上面的一些理解，尝试着写作基于ETF的交易策略。

## 下周计划
