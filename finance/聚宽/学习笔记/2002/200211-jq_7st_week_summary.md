# 聚宽学习第七周周记：基金定投策略

## 一、`获取处于历史地位的ETF基金`代码解释


## 二、上周计划任务

### 1.什么是网格交易？

宽友@odbo有一次提到“网格交易”这个名词，自己还没有了解过，做些学习和了解。

### 2.修改之前第一个模拟定投的策略，计算下真实收益率

## 三、本周新学内容

### 如何在策略完成时计算策略的总体收益率？

在执行策略的时候需要在策略完成时计算策略的内部收益率（IRR），但是从写的第一个简单策略里面只有针对定时运行策略的控制，比如可以给run_daily/run_weekly/run_monthly 指定before_market_open/market_open/after_market_close分别在开盘前、中、后执行，但我想要的是在整个策略执行完成的时候计算策略的总体收益。

于是决定阅读[API文档](https://www.joinquant.com/help/api/help?name=api#%E7%AD%96%E7%95%A5%E7%A8%8B%E5%BA%8F%E6%9E%B6%E6%9E%84%E2%99%A6)，在策略程序架构章节里面发现了可以完成这项功能的函数`on_strategy_end()`，定义如下：

```
def on_strategy_end(context)

在回测、模拟交易正常结束时被调用， 失败时不会被调用。

在模拟交易到期结束时也会被调用， 手动在到期前关闭不会被调用。
```

这个函数会默认调用，可以通过重写这个函数来决定策略执行结束时做什么。

### 统计基金当日的交易量

https://www.joinquant.com/help/api/help?name=fund#%E8%8E%B7%E5%8F%96%E5%8D%95%E6%94%AF%E5%9F%BA%E9%87%91%E6%95%B0%E6%8D%AE

### 如何获取创业板指数的市盈率？
