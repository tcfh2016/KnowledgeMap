# 聚宽学习周记二四：

在按照自己的思路来进行动量分析的时候，发现并没有完全理解[高频因子探索——动量交易](https://www.joinquant.com/view/community/detail/22472)里面的内容，也就是说我在[]()里面对于“收益率计算”的那部分讲解其实不够细致。这里先将上周动量研究的思路复习一下，实际上里面有两条线，第一条线是接用动量来研究可能的规律；第二条线是根据假设来对动量的研究结论进行收益率试算。

1. 规律的探寻

首先，获取一段日期内每一天沪深300指数所有成分股的动量数据，并保存为字典类型的数据，字典以日期为“键”，以对应日期所有300只样本股的动量数据为“值”。

```
2019-01-02

             open_profit  next_profit  back_profit
000001.XSHE     0.002165    -0.010057    -0.011388
000002.XSHE    -0.001455    -0.006557    -0.031524
000063.XSHE     0.009498    -0.008480    -0.012597
……

2019-01-03

             open_profit  next_profit  back_profit
000001.XSHE     0.002216     0.002972    -0.019108
000002.XSHE     0.002251    -0.002992    -0.047088
000063.XSHE     0.001596     0.014887    -0.018002
……
```

然后，将所有这些数据进行按行合并，并且将index由样本股代码更改为数字序号。并从中抽取一部分数据来进行分析，主要是通过画热力图和条形图来看是否有明显的规律。

```
合并动量数据：
             open_profit   back_profit   next_profit
1               0.002165     -0.011388     -0.010057
2              -0.001455     -0.031524     -0.006557
3               0.009498     -0.012597     -0.008480
……
4               0.002216     -0.019108      0.002972
5               0.002251     -0.047088     -0.002992
6               0.001596     -0.018002      0.014887

截取部分数据：
             open_profit   back_profit   next_profit
3               0.009498     -0.012597     -0.008480
……
4               0.002216     -0.019108      0.002972
```

之后，对截取的这部分数据进行分层处理，也就是将`open_profit`, `back_profit`两列使用对应列百分比来替代。这些数据就是画图时候的最终输入数据了。

```
             open_profit   back_profit   next_profit
3                    2.0           7.0     -0.008480
……
4                    5.0           1.0      0.002972
```

2. 计算收益率

收益率计算的处理过程和上面是不一样的，它的输入数据并不是上面最终的“从所有动量数据里面截取的部分，并进行分层处理后的数据”，而是上面第一步里面获取到的“按照日期和对应日期里所有样本股动量数据组成的字典数据”。它是如何通过这些动量数据来进行收益率计算的？

我们已经拥有了每天的沪深300股成分股的数据，并且根据“规律的探寻”已经知道了“开盘时的动量可能对收盘价有一定的影响”，所以我们就需要评估并且选择这种影响，于是有：

- 对每一天的300只样本股的开盘动量进行分层，共分10层。这里面每层实际上代表着“1只或者多只样本股”。
- 选择特定的层来计算收益，这里面的意思包括：
  - 选择特定的层相当于在指定期限内每个交易日都选择特定的层；
  - 这里“特定的层”就相当于“300只股票里面开盘动量处于特定层的那些股票”；
  - 这样，其实就相当于每个交易日都在不停地买进/卖出不同的股票集合。
- 最后计算每天的累计收益，然后与沪深300指数的基准收益进行对比。

收益率的计算上周我觉得应该讲清楚了，这里权且讲按照动量数据进行交易的细节部分再回顾清楚。


## 一、代码解释


## 二、上周计划

1. 理解了这篇文章之后觉得有两个作业要做完来加深理解，其一为重新实现文中的函数，并且按照上面自己提到的以半天计算动量的方式来进行探索；其二为基于探索的结果写作简单的策略来观察执行效果。

2. 上周遗留作业：基于本周学习到的新的动量计算算法，以及前面两周研究指数上面的一些理解，尝试着写作基于ETF的交易策略。

## 三、新学内容

1. 之前切分时的一个问题

分层之后的数据最高层实际上是没有纳入最终结果的。

## 四、下周计划


@洪武 推荐了一个基金参考策略：[](https://bigquant.com/community/t/topic/181963)，说可以实现下。
